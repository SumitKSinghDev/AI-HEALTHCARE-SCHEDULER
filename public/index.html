<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Scheduler - Smart AI-Powered Healthcare Booking</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #1a202c;
            background: #f8fafc;
            overflow-x: hidden;
        }

        /* Navbar Styles */
        .navbar {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 0 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.06);
        }

        .navbar.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            height: 75px;
            flex-wrap: nowrap;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: #1a202c;
            font-weight: 800;
            font-size: 1.4rem;
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(59, 130, 246, 0.02));
        }

        .nav-brand:hover {
            transform: translateY(-2px);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05));
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
        }

        .nav-brand i {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-right: 12px;
            font-size: 2rem;
        }

        .nav-brand span {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            align-items: center;
            gap: 1.2rem;
            margin: 0;
            padding: 0;
            flex-wrap: nowrap;
        }

        .nav-item a {
            text-decoration: none;
            color: #4a5568;
            font-weight: 500;
            font-size: 0.95rem;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            white-space: nowrap;
            display: flex;
            align-items: center;
        }

        .nav-item a:hover {
            color: #3b82f6;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(59, 130, 246, 0.08));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.2);
        }

        .nav-item.cta a {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            white-space: nowrap;
            min-width: fit-content;
        }

        .nav-item.cta a:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            color: white;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #4a5568;
            cursor: pointer;
        }

        /* Hero Section */
        .hero {
            background: 
                linear-gradient(135deg, rgba(59, 130, 246, 0.6), rgba(30, 64, 175, 0.6)), 
                url('image.png'),
                linear-gradient(135deg, #3b82f6, #1e40af);
            background-size: cover, cover, cover;
            background-position: center, center, center;
            background-repeat: no-repeat, no-repeat, no-repeat;
            background-attachment: scroll;
            padding: 120px 0 80px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
            min-height: 100vh;
        }

        /* Fallback for image loading */
        @supports not (background-blend-mode: overlay) {
            .hero {
                background: linear-gradient(135deg, #3b82f6, #1e40af);
            }
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.1);
            opacity: 0.5;
        }

        .hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 70%, rgba(59, 130, 246, 0.2) 0%, transparent 60%), 
                        radial-gradient(circle at 70% 30%, rgba(30, 64, 175, 0.2) 0%, transparent 60%);
            animation: aiGlow 6s ease-in-out infinite alternate;
            pointer-events: none;
        }

        @keyframes aiGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.7; }
        }

        @keyframes aiPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .ai-avatar {
            text-align: center;
            margin-bottom: 2rem;
        }

        .ai-status {
            margin-top: 1rem;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .ai-features-preview {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .ai-feature-tag {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .ai-feature-tag:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .ai-feature-tag i {
            font-size: 1rem;
        }

        .hero-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .hero p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            opacity: 0.95;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);
            color: rgba(255, 255, 255, 0.95);
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 3rem;
        }

        .btn-primary, .btn-secondary {
            padding: 14px 28px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffffff, #f1f5f9);
            color: #1e40af;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 255, 255, 0.4);
            color: #1e40af;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
            color: white;
        }

        /* Hospital Logos */
        .hospital-logos {
            margin-top: 3rem;
            opacity: 0.8;
        }

        .hospital-logos p {
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            opacity: 0.7;
        }

        .logos-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3rem;
            flex-wrap: wrap;
        }

        .hospital-logo {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hospital-logo:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Main Content */
        .main-content {
            margin-top: 70px;
            min-height: calc(100vh - 70px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Page Sections */
        .page-section {
            display: none;
            padding: 2rem 0;
            min-height: 80vh;
        }

        .page-section.active {
            display: block;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 1rem;
            text-align: center;
        }

        .section-subtitle {
            color: #4a5568;
            text-align: center;
            margin-bottom: 3rem;
            font-size: 1.1rem;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 40px rgba(0, 0, 0, 0.12);
        }

        .card h3 {
            color: #1e40af;
            margin-bottom: 1rem;
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #ffffff;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            padding: 20px;
            z-index: 10000;
            transform: translateX(400px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 400px;
            border-left: 4px solid #10b981;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast-icon {
            background: #10b981;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .toast-message {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 4px;
        }

        .toast-text {
            color: #4a5568;
            font-size: 0.9rem;
        }

        .toast-close {
            background: none;
            border: none;
            color: #a0aec0;
            cursor: pointer;
            font-size: 18px;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
        }

        /* Features Section */
        .features-section {
            padding: 4rem 0;
            background: white;
        }

        .feature-card {
            text-align: center;
            padding: 2rem;
            border-radius: 16px;
            background: #f8fafc;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            background: white;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transform: translateY(-4px);
        }

        .feature-icon {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 1rem;
        }

        .feature-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }

        .feature-description {
            color: #4a5568;
            line-height: 1.6;
        }

        /* Footer */
        .footer {
            background: #1a202c;
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-top: 4rem;
        }

        .footer p {
            opacity: 0.8;
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .nav-menu {
                gap: 1rem;
            }
            
            .nav-item a {
                padding: 6px 12px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.98);
                backdrop-filter: blur(20px);
                flex-direction: column;
                padding: 1rem 2rem;
                border-top: 1px solid rgba(226, 232, 240, 0.8);
                gap: 0.5rem;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            .nav-menu.active {
                display: flex;
            }

            .nav-item {
                width: 100%;
                margin: 0.5rem 0;
            }

            .nav-item a {
                display: block;
                padding: 12px 16px;
                width: 100%;
                text-align: center;
            }

            .mobile-menu-btn {
                display: block;
            }

            .hero {
                padding: 100px 0 60px;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }

            .btn-primary, .btn-secondary {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .logos-container {
                gap: 1rem;
                flex-direction: column;
                align-items: center;
            }

            .hospital-logo {
                font-size: 0.8rem;
                padding: 8px 16px;
                width: 200px;
                text-align: center;
            }

            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .feature-card {
                padding: 1.5rem;
            }

            .feature-icon {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }

            .feature-title {
                font-size: 1.1rem;
            }

            .feature-description {
                font-size: 0.9rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .section-subtitle {
                font-size: 1rem;
            }

            .ai-features-preview {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }

            .ai-feature-tag {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }

            .ai-avatar img {
                width: 80px !important;
                height: 80px !important;
            }

            .hospital-logo {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
                padding: 1rem;
            }

            .hospital-logo img {
                margin-right: 0 !important;
                margin-bottom: 0.5rem;
            }

            .toast {
                right: 10px;
                left: 10px;
                max-width: none;
                transform: translateY(-100px);
            }

            .toast.show {
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .nav-container {
                padding: 0 1rem;
            }

            .hero {
                padding: 100px 0 60px;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .container {
                padding: 0 1rem;
            }
        }

        /* Animation Classes */
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .loading .btn {
            position: relative;
        }

        .loading .btn::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            margin: auto;
            border: 2px solid transparent;
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 50% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }

        .modal-header {
            padding: 2rem 2rem 1rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            color: #1a202c;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .modal-body {
            padding: 2rem;
        }

        /* Receipt Styles */
        #receipt-content {
            background: #f9fafb;
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            font-family: 'Courier New', monospace;
        }

        .receipt-header {
            text-align: center;
            margin-bottom: 2rem;
            border-bottom: 2px solid #374151;
            padding-bottom: 1rem;
        }

        .receipt-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.25rem 0;
        }

        .receipt-row.total {
            border-top: 1px solid #374151;
            margin-top: 1rem;
            padding-top: 1rem;
            font-weight: bold;
        }

        .receipt-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* Payment Options */
        .payment-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .payment-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-option:hover {
            border-color: #3b82f6;
            background: #f0f9ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
        }

        .payment-option div {
            flex: 1;
        }

        .payment-option h3 {
            color: #1a202c;
            margin-bottom: 0.25rem;
        }

        .payment-option p {
            color: #6b7280;
            font-size: 0.9rem;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 1rem;
            }

            .modal-header,
            .modal-body {
                padding: 1.5rem;
            }

            .receipt-actions {
                flex-direction: column;
            }

            .receipt-actions .btn {
                width: 100%;
                justify-content: center;
            }

            .payment-option {
                padding: 1rem;
            }

            .payment-option h3 {
                font-size: 1rem;
            }

            .payment-option p {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <a href="#" class="nav-brand" onclick="showPage('home')">
                <span style="font-size: 2rem; margin-right: 8px;">🏥</span>
                <span>AI Hospital Scheduler</span>
            </a>
            
            <ul class="nav-menu" id="nav-menu">
                <li class="nav-item">
                    <a href="#" onclick="showPage('appointments')">📅 My Appointments</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showPage('booking')">🤖 Book Appointment</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showPage('ai-chat')">💬 AI Chat</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showPage('search-hospitals')">🔍 Search Hospitals</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showPage('admin')">⚙️ Admin</a>
                </li>
                <li class="nav-item">
                    <a href="#" onclick="showPage('login')">🔐 Login</a>
                </li>
                <li class="nav-item cta">
                    <a href="#" onclick="showPage('signup')">✨ Sign Up</a>
                </li>
            </ul>
            
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <span style="font-size: 1.5rem;">📱</span>
            </button>
        </div>
    </nav>

    <div class="main-content">
        <!-- Home Page -->
        <div id="home" class="page-section active">
            <!-- Hero Section -->
            <section class="hero">
                <div class="hero-container">
                    <!-- AI Avatar -->
                    <div class="ai-avatar">
                        <div style="font-size: 8rem; margin-bottom: 1rem; animation: aiPulse 2s ease-in-out infinite;">🤖</div>
                        <div class="ai-status">
                            <span style="font-size: 1.5rem; margin-right: 0.5rem; animation: pulse 1.5s infinite;">🟢</span>
                            <span style="font-size: 0.9rem; opacity: 0.9;">AI Assistant Online</span>
                        </div>
                    </div>

                    <h1>🤖 AI-Powered Healthcare Scheduling</h1>
                    <p>Experience the future of healthcare with our intelligent AI assistant. Get instant symptom analysis, smart appointment scheduling, and personalized doctor recommendations powered by advanced machine learning.</p>
                    
                    <div class="ai-features-preview">
                        <div class="ai-feature-tag">
                            <span style="font-size: 1.2rem; margin-right: 0.5rem;">🧠</span>
                            <span>Smart Symptom Analysis</span>
                        </div>
                        <div class="ai-feature-tag">
                            <span style="font-size: 1.2rem; margin-right: 0.5rem;">🤖</span>
                            <span>AI Doctor Matching</span>
                        </div>
                        <div class="ai-feature-tag">
                            <span style="font-size: 1.2rem; margin-right: 0.5rem;">✨</span>
                            <span>Predictive Scheduling</span>
                        </div>
                    </div>
                    
                    <div class="hero-buttons">
                        <a href="#" class="btn-primary" onclick="showPage('booking')">
                            <span style="font-size: 1.2rem; margin-right: 0.5rem;">🤖</span>
                            Start AI Booking
                        </a>
                        <a href="#" class="btn-secondary" onclick="showPage('ai-chat')">
                            <span style="font-size: 1.2rem; margin-right: 0.5rem;">💬</span>
                            Chat with AI
                        </a>
                    </div>

                    <div class="hospital-logos">
                        <p>🏥 Trusted by leading healthcare providers</p>
                        <div class="logos-container">
                            <div class="hospital-logo">
                                <span style="font-size: 1.5rem; margin-right: 8px;">🏥</span>
                                Apollo Hospitals
                            </div>
                            <div class="hospital-logo">
                                <span style="font-size: 1.5rem; margin-right: 8px;">🏥</span>
                                Fortis Healthcare
                            </div>
                            <div class="hospital-logo">
                                <span style="font-size: 1.5rem; margin-right: 8px;">🏥</span>
                                Max Healthcare
                            </div>
                            <div class="hospital-logo">
                                <span style="font-size: 1.5rem; margin-right: 8px;">🏥</span>
                                Manipal Hospitals
                            </div>
                            <div class="hospital-logo">
                                <span style="font-size: 1.5rem; margin-right: 8px;">🏥</span>
                                Narayana Health
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Features Section -->
            <section class="features-section">
                <div class="container">
                    <h2 class="section-title">🤖 AI-Powered Healthcare Features</h2>
                    <p class="section-subtitle">Experience the future of healthcare with intelligent automation</p>
                    <div class="grid-3">
                        <div class="feature-card">
                            <div style="font-size: 4rem; margin: 0 auto 1rem;">🤖</div>
                            <div class="feature-title">🧠 Smart AI Assistant</div>
                            <div class="feature-description">Advanced machine learning algorithms analyze your symptoms and provide intelligent healthcare recommendations 24/7.</div>
                        </div>
                        <div class="feature-card">
                            <div style="font-size: 4rem; margin: 0 auto 1rem;">⚡</div>
                            <div class="feature-title">⚡ Predictive Scheduling</div>
                            <div class="feature-description">AI predicts optimal appointment slots based on doctor availability, patient history, and urgency levels.</div>
                        </div>
                        <div class="feature-card">
                            <div style="font-size: 4rem; margin: 0 auto 1rem;">🎯</div>
                            <div class="feature-title">🎯 Intelligent Matching</div>
                            <div class="feature-description">Machine learning matches you with the perfect doctor based on symptoms, language, and medical history.</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Payment Options Section -->
            <section style="padding: 4rem 0; background: linear-gradient(135deg, #f0f9ff, #e0f2fe);">
                <div class="container">
                    <h2 class="section-title">💳 Secure Payment Options</h2>
                    <p class="section-subtitle">Multiple payment methods for your convenience</p>
                    
                    <div class="grid-3">
                        <div class="feature-card" style="background: white; cursor: pointer;" onclick="showToast('Razorpay', 'Book an appointment to use Razorpay payment', 'info')">
                            <div style="font-size: 4rem; margin: 0 auto 1rem;">💳</div>
                            <div class="feature-title">💳 Razorpay Integration</div>
                            <div class="feature-description">Secure online payments with UPI, Cards, Net Banking, and Wallets.</div>
                        </div>
                        <div class="feature-card" style="background: white;">
                            <div style="font-size: 4rem; margin: 0 auto 1rem;">📱</div>
                            <div class="feature-title">📱 UPI Payments</div>
                            <div class="feature-description">Quick payments with Google Pay, PhonePe, Paytm, and other UPI apps.</div>
                        </div>
                        <div class="feature-card" style="background: white;">
                            <div style="font-size: 4rem; margin: 0 auto 1rem;">🧾</div>
                            <div class="feature-title">🧾 Instant Receipts</div>
                            <div class="feature-description">Get detailed receipts instantly. Print or save for your records.</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Book Appointment Page -->
        <div id="booking" class="page-section">
            <div class="container">
                <h2 class="section-title">🤖 Book Your AI-Powered Appointment</h2>
                <p class="section-subtitle">Fill in your details to schedule an appointment with our healthcare professionals</p>
                
                <!-- Login Required Notice -->
                <div id="login-required-notice" class="card" style="display: none; text-align: center; background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #f59e0b; margin-bottom: 2rem;">
                    <i class="fas fa-user-lock" style="font-size: 3rem; color: #d97706; margin-bottom: 1rem;"></i>
                    <h3 style="color: #92400e; margin-bottom: 1rem;">Login Required</h3>
                    <p style="color: #a16207; margin-bottom: 1.5rem;">You need to create an account or login to book appointments. This helps us keep track of your medical history and appointments.</p>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button onclick="showPage('signup')" class="btn" style="background: linear-gradient(135deg, #10b981, #059669);">
                            <i class="fas fa-user-plus"></i>
                            Create Account
                        </button>
                        <button onclick="showPage('login')" class="btn" style="background: linear-gradient(135deg, #3b82f6, #1e40af);">
                            <i class="fas fa-sign-in-alt"></i>
                            Login
                        </button>
                    </div>
                </div>
                
                <div class="card" id="booking-form-container">
                    <form id="booking-form">
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="patient-name">Full Name</label>
                                <input type="text" id="patient-name" name="patientName" required>
                            </div>
                            <div class="form-group">
                                <label for="mobile">Mobile Number</label>
                                <input type="tel" id="mobile" name="mobile" placeholder="+91 9876543210" required>
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="age">Age</label>
                                <input type="number" id="age" name="age" min="1" max="120" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="symptoms">Describe Your Symptoms</label>
                            <textarea id="symptoms" name="symptoms" rows="3" placeholder="Please describe your symptoms or health concerns..."></textarea>
                        </div>

                        <div class="grid-2">
                            <div class="form-group">
                                <label for="preferred-date">Preferred Date</label>
                                <input type="date" id="preferred-date" name="preferredDate" required>
                            </div>
                            <div class="form-group">
                                <label for="preferred-time">Preferred Time</label>
                                <select id="preferred-time" name="preferredTime" required>
                                    <option value="">Select Time</option>
                                    <option value="09:00">09:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="14:00">02:00 PM</option>
                                    <option value="15:00">03:00 PM</option>
                                    <option value="16:00">04:00 PM</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid-2">
                            <div class="form-group">
                                <label for="doctor">Select Doctor</label>
                                <select id="doctor" name="doctor" required>
                                    <option value="">Choose Doctor</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="language">Preferred Language</label>
                                <select id="language" name="language">
                                    <option value="English">English</option>
                                    <option value="Hindi">Hindi</option>
                                    <option value="Marathi">Marathi</option>
                                    <option value="Tamil">Tamil</option>
                                    <option value="Telugu">Telugu</option>
                                </select>
                            </div>
                        </div>

                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <button type="submit" class="btn">
                                <i class="fas fa-calendar-plus"></i>
                                Book Appointment
                            </button>
                            <button type="button" class="btn" style="background: #6b7280;" onclick="refreshData()">
                                <i class="fas fa-refresh"></i>
                                Refresh Data
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- My Appointments Page -->
        <div id="appointments" class="page-section">
            <div class="container">
                <h2 class="section-title">📅 My Appointments</h2>
                <p class="section-subtitle">View, cancel, or reschedule your booked appointments</p>
                
                <div id="appointments-list">
                    <!-- Appointments will be loaded here -->
                </div>
            </div>
        </div>

        <!-- AI Chat Page -->
        <div id="ai-chat" class="page-section">
            <div class="container">
                <h2 class="section-title">🤖 Ask Our AI Assistant</h2>
                <p class="section-subtitle">Get instant answers about doctor availability, hospital timings, departments, and appointment booking. Our AI assistant is here to help 24/7.</p>
                
                <div class="card" style="background: linear-gradient(135deg, #f8fafc, #e2e8f0); border: 2px solid rgba(59, 130, 246, 0.2);">
                    <div id="chat-container" style="height: 400px; overflow-y: auto; border: 2px solid rgba(59, 130, 246, 0.3); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; background: linear-gradient(135deg, #ffffff, #f8fafc);">
                        <div style="text-align: center; color: #6b7280; padding: 2rem;">
                            <div style="font-size: 5rem; margin-bottom: 1rem; animation: aiPulse 2s ease-in-out infinite;">🤖</div>
                            <div style="background: rgba(59, 130, 246, 0.1); border-radius: 20px; padding: 1rem; margin: 1rem 0;">
                                <p><strong>🤖 AI Healthcare Assistant</strong></p>
                                <p style="margin-top: 0.5rem;">Hello! I'm powered by advanced AI to help with your healthcare needs. Ask me about:</p>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; margin-top: 1rem;">
                                    <span style="background: #3b82f6; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">🩺 Symptoms</span>
                                    <span style="background: #10b981; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">👨‍⚕️ Doctors</span>
                                    <span style="background: #8b5cf6; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">📅 Appointments</span>
                                    <span style="background: #f59e0b; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;">🏥 Hospitals</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; position: relative;">
                        <input type="text" id="chat-input" placeholder="Ask AI: 'I have a headache, which doctor should I see?'" style="flex: 1; padding: 12px 16px; border: 2px solid rgba(59, 130, 246, 0.3); border-radius: 25px; background: white; font-size: 1rem;">
                        <button onclick="sendMessage()" class="btn" style="border-radius: 25px; padding: 12px 20px;">
                            <span style="font-size: 1.2rem; margin-right: 0.5rem;">🤖</span>
                            Ask AI
                        </button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 1rem; font-size: 0.9rem; color: #6b7280;">
                        <i class="fas fa-shield-alt" style="color: #10b981; margin-right: 0.5rem;"></i>
                        Powered by OpenAI GPT-3.5 • Your data is secure and private
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Hospitals Page -->
        <div id="search-hospitals" class="page-section">
            <div class="container">
                <h2 class="section-title">🏥 Search Hospitals</h2>
                <p class="section-subtitle">Find hospitals and clinics near you with specialized services</p>
                
                <div class="card">
                    <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                        <input type="text" id="hospital-search" placeholder="Search by hospital name, location, or specialty..." style="flex: 1; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        <button onclick="searchHospitals()" class="btn">
                            <i class="fas fa-search"></i>
                            Search
                        </button>
                    </div>
                    
                    <div id="hospitals-list" class="grid-2">
                        <!-- Hospitals will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Login Page -->
        <div id="login" class="page-section">
            <div class="container">
                <div style="max-width: 400px; margin: 0 auto;">
                    <h2 class="section-title">🔐 Login</h2>
                    <p class="section-subtitle">Access your account to manage appointments</p>
                    
                    <div class="card">
                        <form id="login-form">
                            <div class="form-group">
                                <label for="login-email">Email Address</label>
                                <input type="email" id="login-email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="login-password">Password</label>
                                <input type="password" id="login-password" name="password" required>
                            </div>
                            <button type="submit" class="btn" style="width: 100%;">
                                <i class="fas fa-sign-in-alt"></i>
                                Login
                            </button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 1rem;">
                            <p>Don't have an account? <a href="#" onclick="showPage('signup')" style="color: #3b82f6;">Sign up here</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Panel Page -->
        <div id="admin" class="page-section">
            <div class="container">
                <h2 class="section-title">⚙️ Admin Dashboard</h2>
                <p class="section-subtitle">Manage hospital appointments and view patient details</p>
                
                <!-- Doctor Login Section -->
                <div id="doctor-login-section" class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border: 2px solid rgba(59, 130, 246, 0.3);">
                    <h3 style="margin-bottom: 1rem; color: #1e40af;">👨‍⚕️ Doctor Login</h3>
                    <p style="margin-bottom: 1.5rem; color: #64748b;">Login with your doctor credentials to manage appointments</p>
                    
                    <div style="display: flex; gap: 1rem; align-items: end; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">Doctor ID</label>
                            <input type="text" id="doctor-id" placeholder="e.g., DOC001" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">Password</label>
                            <input type="password" id="doctor-password" placeholder="Enter password" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        </div>
                        <button onclick="loginAsDoctor()" class="btn" style="padding: 12px 24px; white-space: nowrap;">
                            <span style="font-size: 1.1rem; margin-right: 0.5rem;">👨‍⚕️</span>
                            Doctor Login
                        </button>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 8px; font-size: 0.9rem; color: #1e40af;">
                        <strong>Demo Credentials:</strong><br>
                        Doctor ID: DOC001 | Password: doctor123<br>
                        Doctor ID: DOC002 | Password: doctor456
                    </div>
                </div>
                
                <!-- Admin Content (hidden until doctor login) -->
                <div id="admin-content" style="display: none;">
                
                <!-- Admin Stats -->
                <div class="grid-3" style="margin-bottom: 3rem;">
                    <div class="card" style="text-align: center;">
                        <div style="background: linear-gradient(135deg, #3b82f6, #1e40af); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 1.5rem;">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <h3 style="color: #1e40af; margin-bottom: 0.5rem;">Total Appointments</h3>
                        <p style="font-size: 2rem; font-weight: 700; color: #1a202c;" id="total-appointments">0</p>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="background: linear-gradient(135deg, #10b981, #059669); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 1.5rem;">
                            <i class="fas fa-user-md"></i>
                        </div>
                        <h3 style="color: #059669; margin-bottom: 0.5rem;">Active Doctors</h3>
                        <p style="font-size: 2rem; font-weight: 700; color: #1a202c;" id="active-doctors">0</p>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 1.5rem;">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h3 style="color: #d97706; margin-bottom: 0.5rem;">Pending Approvals</h3>
                        <p style="font-size: 2rem; font-weight: 700; color: #1a202c;" id="pending-appointments">0</p>
                    </div>
                </div>

                <!-- Search and Filter -->
                <div class="card" style="margin-bottom: 2rem;">
                    <div class="grid-2">
                        <div class="form-group">
                            <label for="admin-search">Search Patient or Appointment ID</label>
                            <input type="text" id="admin-search" placeholder="Enter patient name or appointment ID..." onkeyup="filterAppointments()">
                        </div>
                        <div class="form-group">
                            <label for="status-filter">Filter by Status</label>
                            <select id="status-filter" onchange="filterAppointments()">
                                <option value="">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Appointments Management -->
                <div class="card">
                    <h3 style="margin-bottom: 2rem;">All Appointments</h3>
                    <div id="admin-appointments-list">
                        <!-- Admin appointments will be loaded here -->
                    </div>
                </div>
                
                </div> <!-- Close admin-content -->
            </div>
        </div>

        <!-- Signup Page -->
        <div id="signup" class="page-section">
            <div class="container">
                <div style="max-width: 500px; margin: 0 auto;">
                    <h2 class="section-title">✨ Sign Up</h2>
                    <p class="section-subtitle">Create your account to start booking appointments</p>
                    
                    <div class="card">
                        <form id="signup-form">
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="signup-firstname">First Name</label>
                                    <input type="text" id="signup-firstname" name="firstName" required>
                                </div>
                                <div class="form-group">
                                    <label for="signup-lastname">Last Name</label>
                                    <input type="text" id="signup-lastname" name="lastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="signup-email">Email Address</label>
                                <input type="email" id="signup-email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="signup-mobile">Mobile Number</label>
                                <input type="tel" id="signup-mobile" name="mobile" placeholder="+91 9876543210" required>
                            </div>
                            <div class="form-group">
                                <label for="signup-password">Password</label>
                                <input type="password" id="signup-password" name="password" required>
                            </div>
                            <div class="form-group">
                                <label for="signup-confirm-password">Confirm Password</label>
                                <input type="password" id="signup-confirm-password" name="confirmPassword" required>
                            </div>
                            <button type="submit" class="btn" style="width: 100%;">
                                <i class="fas fa-user-plus"></i>
                                Create Account
                            </button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 1rem;">
                            <p>Already have an account? <a href="#" onclick="showPage('login')" style="color: #3b82f6;">Login here</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>For educational purposes only – Demo Website</p>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="toast-content">
            <div class="toast-icon">
                <i class="fas fa-check"></i>
            </div>
            <div class="toast-message">
                <div class="toast-title">Success!</div>
                <div class="toast-text">Your action was completed successfully.</div>
            </div>
            <button class="toast-close" onclick="hideToast()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receipt-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-receipt"></i> Appointment Receipt</h2>
                <button class="modal-close" onclick="closeReceiptModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="receipt-content">
                    <!-- Receipt content will be populated here -->
                </div>
                <div class="receipt-actions">
                    <button onclick="printReceipt()" class="btn" style="background: #10b981;">
                        <i class="fas fa-print"></i>
                        Print Receipt
                    </button>
                    <button onclick="showPaymentOptions()" class="btn" style="background: #3b82f6;">
                        <i class="fas fa-credit-card"></i>
                        Make Payment
                    </button>
                    <button onclick="closeReceiptModal()" class="btn" style="background: #6b7280;">
                        <i class="fas fa-times"></i>
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="payment-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-credit-card"></i> Payment Options</h2>
                <button class="modal-close" onclick="closePaymentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="payment-options">
                    <div class="payment-option" onclick="processRazorpayPayment()">
                        <div style="font-size: 3rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">💳</div>
                        <div>
                            <h3>💳 Razorpay Payment</h3>
                            <p>Secure online payment with UPI, Cards, Net Banking</p>
                        </div>
                        <span style="font-size: 1.2rem;">➡️</span>
                    </div>
                    <div class="payment-option" onclick="showUPIPayment()">
                        <div style="font-size: 3rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">📱</div>
                        <div>
                            <h3>📱 UPI Payment</h3>
                            <p>Pay with Google Pay, PhonePe, Paytm</p>
                        </div>
                        <span style="font-size: 1.2rem;">➡️</span>
                    </div>
                    <div class="payment-option" onclick="showCardPayment()">
                        <div style="font-size: 3rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">💳</div>
                        <div>
                            <h3>💳 Card Payment</h3>
                            <p>Debit Card, Credit Card</p>
                        </div>
                        <span style="font-size: 1.2rem;">➡️</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let appointments = [];
        let doctors = [];
        let hospitals = [];
        let allAppointments = []; // For admin panel
        let filteredAppointments = []; // For admin filtering

        // Initialize empty arrays to prevent undefined errors
        function initializeArrays() {
            if (!Array.isArray(appointments)) appointments = [];
            if (!Array.isArray(doctors)) doctors = [];
            if (!Array.isArray(hospitals)) hospitals = [];
            if (!Array.isArray(allAppointments)) allAppointments = [];
            if (!Array.isArray(filteredAppointments)) filteredAppointments = [];
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeArrays();
            restoreUserSession();
            initializeApp();
            setupEventListeners();
            loadInitialData();
            
            // Check if background image loads
            const img = new Image();
            img.onload = function() {
                console.log('✅ Background image loaded successfully');
                // Force apply the background image
                const heroElement = document.querySelector('.hero');
                if (heroElement) {
                    heroElement.style.backgroundImage = 
                        'linear-gradient(135deg, rgba(59, 130, 246, 0.6), rgba(30, 64, 175, 0.6)), url("image.png")';
                }
            };
            img.onerror = function() {
                console.log('❌ Background image failed to load, using gradient fallback');
            };
            img.src = 'image.png?v=' + Date.now(); // Add cache busting
        });

        function restoreUserSession() {
            // Check if user was previously logged in
            const storedUser = localStorage.getItem('currentUser');
            if (storedUser) {
                try {
                    currentUser = JSON.parse(storedUser);
                    updateNavbarForLoggedInUser();
                } catch (error) {
                    console.error('Failed to restore user session:', error);
                    localStorage.removeItem('currentUser');
                }
            }
        }

        function initializeApp() {
            // Set minimum date for appointment booking
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('preferred-date').min = today;
            
            // Initialize navbar scroll effect
            window.addEventListener('scroll', function() {
                const navbar = document.getElementById('navbar');
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });
        }

        function setupEventListeners() {
            // Booking form submission
            document.getElementById('booking-form').addEventListener('submit', handleBookingSubmission);
            
            // Login form submission
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            
            // Signup form submission
            document.getElementById('signup-form').addEventListener('submit', handleSignup);
            
            // Chat input enter key
            document.getElementById('chat-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        async function loadInitialData() {
            try {
                console.log('Loading initial data...');
                
                // Load doctors with cache busting
                const doctorsResponse = await fetch('/api/doctors?t=' + Date.now());
                if (!doctorsResponse.ok) {
                    throw new Error(`Doctors API failed: ${doctorsResponse.status}`);
                }
                const doctorsData = await doctorsResponse.json();
                doctors = Array.isArray(doctorsData) ? doctorsData : (doctorsData.doctors || []);
                console.log('Loaded doctors:', doctors.length);
                populateDoctorSelect();
                
                // Load hospitals with cache busting
                const hospitalsResponse = await fetch('/api/locations?t=' + Date.now());
                if (!hospitalsResponse.ok) {
                    throw new Error(`Locations API failed: ${hospitalsResponse.status}`);
                }
                const hospitalsData = await hospitalsResponse.json();
                hospitals = Array.isArray(hospitalsData) ? hospitalsData : (hospitalsData.locations || []);
                console.log('Loaded hospitals:', hospitals.length);
                displayHospitals(hospitals);
                
                // Load appointments if user is logged in
                if (currentUser) {
                    loadUserAppointments();
                }
                
                console.log('Initial data loaded successfully');
            } catch (error) {
                console.error('Error loading initial data:', error);
                // Show user-friendly error
                showToast('Loading Error', `Failed to load data: ${error.message}. Please refresh the page.`, 'error');
            }
        }

        function populateDoctorSelect() {
            const doctorSelect = document.getElementById('doctor');
            if (!doctorSelect) return;
            
            doctorSelect.innerHTML = '<option value="">Choose Doctor</option>';
            
            if (!doctors || doctors.length === 0) {
                const option = document.createElement('option');
                option.value = '';
                option.textContent = 'No doctors available - Please refresh';
                doctorSelect.appendChild(option);
                return;
            }
            
            doctors.forEach(doctor => {
                const option = document.createElement('option');
                option.value = doctor.id;
                option.textContent = `Dr. ${doctor.name} - ${doctor.specialty}`;
                doctorSelect.appendChild(option);
            });
        }

        async function handleBookingSubmission(e) {
            e.preventDefault();
            
            // Check if user is logged in
            if (!currentUser) {
                showToast('Login Required', 'Please sign up or login to book an appointment', 'error');
                setTimeout(() => {
                    showPage('signup');
                }, 1500);
                return;
            }
            
            const formData = new FormData(e.target);
            const bookingData = Object.fromEntries(formData.entries());
            
            // Add user information to booking
            bookingData.userId = currentUser.id;
            bookingData.userEmail = currentUser.email;
            
            // Add loading state
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('/api/appointments', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(bookingData)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // Generate booking ID
                    const bookingId = 'BK' + Date.now().toString().slice(-6);
                    
                    // Find selected doctor info
                    const selectedDoctor = doctors.find(doc => doc.id === bookingData.doctor);
                    const doctorName = selectedDoctor ? selectedDoctor.name : 'Unknown Doctor';
                    const specialty = selectedDoctor ? selectedDoctor.specialty : 'General';
                    const location = selectedDoctor ? selectedDoctor.location : 'Hospital';
                    
                    // Create appointment object for receipt
                    const appointmentDetails = {
                        id: bookingId,
                        patientName: bookingData.patientName,
                        doctorName: doctorName,
                        specialty: specialty,
                        location: location,
                        date: bookingData.preferredDate,
                        time: bookingData.preferredTime,
                        mobile: bookingData.mobile,
                        email: bookingData.email,
                        symptoms: bookingData.symptoms,
                        language: bookingData.language,
                        bookedAt: new Date().toISOString(),
                        status: 'confirmed'
                    };
                    
                    // Store appointment locally
                    const userAppointments = JSON.parse(localStorage.getItem('userAppointments') || '[]');
                    userAppointments.push(appointmentDetails);
                    localStorage.setItem('userAppointments', JSON.stringify(userAppointments));
                    
                    showToast('Booking Confirmed!', `Your booking is confirmed – Booking ID: ${bookingId}`, 'success');
                    
                    // Show receipt and payment options
                    showBookingReceipt(appointmentDetails);
                    
                    // Reset form
                    e.target.reset();
                    
                } else {
                    throw new Error(result.message || 'Booking failed');
                }
            } catch (error) {
                showToast('Booking Failed', error.message, 'error');
            } finally {
                // Remove loading state
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const loginData = Object.fromEntries(formData.entries());
            
            // Add loading state
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            
            try {
                // Simulate login (in real app, this would be an API call)
                // Check if user exists in localStorage
                const storedUsers = JSON.parse(localStorage.getItem('users') || '[]');
                const user = storedUsers.find(u => u.email === loginData.email && u.password === loginData.password);
                
                if (!user) {
                    throw new Error('Invalid email or password. Please sign up first.');
                }
                
                currentUser = { 
                    id: user.id,
                    email: user.email, 
                    name: user.name,
                    mobile: user.mobile
                };
                
                // Store current user session
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                showToast('Login Successful', `Welcome back, ${currentUser.name}!`, 'success');
                
                setTimeout(() => {
                    showPage('home');
                    updateNavbarForLoggedInUser();
                }, 1500);
            } catch (error) {
                showToast('Login Failed', error.message, 'error');
            } finally {
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        async function handleSignup(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const signupData = Object.fromEntries(formData.entries());
            
            // Add loading state
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            
            try {
                if (signupData.password !== signupData.confirmPassword) {
                    throw new Error('Passwords do not match');
                }
                
                // Check if user already exists
                const storedUsers = JSON.parse(localStorage.getItem('users') || '[]');
                const existingUser = storedUsers.find(u => u.email === signupData.email);
                
                if (existingUser) {
                    throw new Error('User with this email already exists. Please login instead.');
                }
                
                // Create new user
                const newUser = {
                    id: 'user_' + Date.now(),
                    email: signupData.email,
                    name: `${signupData.firstName} ${signupData.lastName}`,
                    mobile: signupData.mobile,
                    password: signupData.password, // In real app, this would be hashed
                    createdAt: new Date().toISOString()
                };
                
                // Store user
                storedUsers.push(newUser);
                localStorage.setItem('users', JSON.stringify(storedUsers));
                
                // Set current user
                currentUser = {
                    id: newUser.id,
                    email: newUser.email,
                    name: newUser.name,
                    mobile: newUser.mobile
                };
                
                // Store current user session
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                showToast('Account Created', `Welcome ${currentUser.name}! You can now book appointments.`, 'success');
                
                // Reset form
                e.target.reset();
                
                setTimeout(() => {
                    showPage('booking');
                    updateNavbarForLoggedInUser();
                }, 2000);
            } catch (error) {
                showToast('Signup Failed', error.message, 'error');
            } finally {
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        function updateNavbarForLoggedInUser() {
            // Update navbar to show user is logged in
            const navMenu = document.getElementById('nav-menu');
            if (!navMenu) return;
            
            const loginItem = navMenu.querySelector('li:nth-last-child(2)');
            const signupItem = navMenu.querySelector('li:last-child');
            
            if (currentUser) {
                // User is logged in
                if (loginItem) loginItem.innerHTML = `<a href="#" onclick="logout()">Logout</a>`;
                if (signupItem) signupItem.innerHTML = `<a href="#" onclick="showPage('appointments')">${currentUser.name}</a>`;
            } else {
                // User is not logged in
                if (loginItem) loginItem.innerHTML = `<a href="#" onclick="showPage('login')">Login</a>`;
                if (signupItem) signupItem.innerHTML = `<a href="#" onclick="showPage('signup')">Sign Up</a>`;
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showToast('Logged Out', 'You have been logged out successfully', 'success');
            setTimeout(() => {
                location.reload();
            }, 1500);
        }

        // Doctor Login System
        let currentDoctor = null;
        
        function loginAsDoctor() {
            const doctorId = document.getElementById('doctor-id').value.trim();
            const password = document.getElementById('doctor-password').value.trim();
            
            if (!doctorId || !password) {
                showToast('Login Error', 'Please enter both Doctor ID and Password', 'error');
                return;
            }
            
            // Demo doctor credentials
            const doctorCredentials = {
                'DOC001': { password: 'doctor123', name: 'Dr. Rajesh Sharma', specialty: 'Cardiology' },
                'DOC002': { password: 'doctor456', name: 'Dr. Priya Patel', specialty: 'Pediatrics' },
                'DOC003': { password: 'doctor789', name: 'Dr. Amit Kumar', specialty: 'Orthopedics' }
            };
            
            if (doctorCredentials[doctorId] && doctorCredentials[doctorId].password === password) {
                currentDoctor = {
                    id: doctorId,
                    name: doctorCredentials[doctorId].name,
                    specialty: doctorCredentials[doctorId].specialty
                };
                
                // Hide login section and show admin content
                document.getElementById('doctor-login-section').style.display = 'none';
                document.getElementById('admin-content').style.display = 'block';
                
                // Update page title to show doctor name
                const pageTitle = document.querySelector('#admin .section-title');
                if (pageTitle) {
                    pageTitle.innerHTML = `👨‍⚕️ Welcome, ${currentDoctor.name}`;
                }
                
                // Add logout button
                const adminContent = document.getElementById('admin-content');
                const logoutBtn = document.createElement('div');
                logoutBtn.innerHTML = `
                    <div style="text-align: right; margin-bottom: 2rem;">
                        <button onclick="logoutDoctor()" class="btn" style="background: #ef4444; border-color: #ef4444;">
                            <span style="font-size: 1rem; margin-right: 0.5rem;">🚪</span>
                            Logout
                        </button>
                    </div>
                `;
                adminContent.insertBefore(logoutBtn, adminContent.firstChild);
                
                showToast('Login Successful', `Welcome ${currentDoctor.name}! You can now manage appointments.`, 'success');
                loadAdminData(); // Refresh admin data
            } else {
                showToast('Login Failed', 'Invalid Doctor ID or Password. Please try again.', 'error');
            }
        }
        
        function logoutDoctor() {
            currentDoctor = null;
            document.getElementById('doctor-login-section').style.display = 'block';
            document.getElementById('admin-content').style.display = 'none';
            
            // Reset page title
            const pageTitle = document.querySelector('#admin .section-title');
            if (pageTitle) {
                pageTitle.innerHTML = '⚙️ Admin Dashboard';
            }
            
            // Clear form
            document.getElementById('doctor-id').value = '';
            document.getElementById('doctor-password').value = '';
            
            showToast('Logged Out', 'Doctor logged out successfully', 'success');
        }

        async function loadUserAppointments() {
            try {
                // Load appointments from both API and localStorage
                const [apiResponse, localAppointments] = await Promise.all([
                    fetch('/api/appointments').then(res => res.json()).catch(() => []),
                    JSON.parse(localStorage.getItem('userAppointments') || '[]')
                ]);
                
                // Combine and deduplicate appointments
                const allAppointments = [...apiResponse, ...localAppointments];
                const uniqueAppointments = allAppointments.filter((appointment, index, self) => 
                    index === self.findIndex(a => a.id === appointment.id)
                );
                
                appointments = uniqueAppointments;
                displayAppointments();
            } catch (error) {
                console.error('Error loading appointments:', error);
                // Fallback to localStorage only
                appointments = JSON.parse(localStorage.getItem('userAppointments') || '[]');
                displayAppointments();
            }
        }

        function displayAppointments() {
            const appointmentsList = document.getElementById('appointments-list');
            
            if (appointments.length === 0) {
                appointmentsList.innerHTML = `
                    <div class="card" style="text-align: center; padding: 3rem;">
                        <i class="fas fa-calendar" style="font-size: 3rem; color: #d1d5db; margin-bottom: 1rem;"></i>
                        <h3 style="color: #6b7280; margin-bottom: 0.5rem;">No Appointments</h3>
                        <p style="color: #9ca3af;">You haven't booked any appointments yet.</p>
                        <button onclick="showPage('booking')" class="btn" style="margin-top: 1rem;">
                            <i class="fas fa-plus"></i>
                            Book Your First Appointment
                        </button>
                    </div>
                `;
                return;
            }
            
            appointmentsList.innerHTML = appointments.map(appointment => {
                // Find the doctor details from the doctors array
                const doctor = doctors.find(doc => doc.id === appointment.doctor || doc.name === appointment.doctorName);
                const doctorName = doctor ? doctor.name : (appointment.doctorName || 'Unknown Doctor');
                const specialty = doctor ? doctor.specialty : (appointment.specialty || 'General Medicine');
                const location = doctor ? doctor.location : (appointment.location || 'Hospital');
                
                return `
                <div class="card">
                    <h3>👨‍⚕️ Dr. ${doctorName}</h3>
                    <p>🩺 ${specialty}</p>
                    <p>📍 ${location}</p>
                    <p>📅 ${new Date(appointment.date || appointment.preferredDate).toLocaleDateString()}</p>
                    <p>🕐 ${appointment.time || appointment.preferredTime}</p>
                    <div style="margin-top: 1rem;">
                        <span style="background: ${getStatusColor(appointment.status)}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">
                            ${appointment.status || 'scheduled'}
                        </span>
                    </div>
                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                        <button class="btn" style="background: #10b981;" onclick="rescheduleAppointment('${appointment.id}')">
                            <span style="margin-right: 0.5rem;">📅</span>
                            Reschedule
                        </button>
                        <button class="btn" style="background: #ef4444;" onclick="cancelAppointment('${appointment.id}')">
                            <span style="margin-right: 0.5rem;">❌</span>
                            Cancel
                        </button>
                    </div>
                </div>
                `;
            }).join('');
        }

        function getStatusColor(status) {
            switch (status.toLowerCase()) {
                case 'confirmed': return '#10b981';
                case 'pending': return '#f59e0b';
                case 'cancelled': return '#ef4444';
                case 'completed': return '#6b7280';
                default: return '#3b82f6';
            }
        }

        function displayHospitals(hospitalsList) {
            const hospitalsContainer = document.getElementById('hospitals-list');
            if (!hospitalsContainer) return;
            
            if (!hospitalsList || !Array.isArray(hospitalsList) || hospitalsList.length === 0) {
                hospitalsContainer.innerHTML = `
                    <div class="card" style="text-align: center; padding: 2rem;">
                        <i class="fas fa-hospital" style="font-size: 2rem; color: #d1d5db; margin-bottom: 1rem;"></i>
                        <h3 style="color: #6b7280;">No Hospitals Available</h3>
                        <p style="color: #9ca3af;">Please refresh the page or try again later.</p>
                        <button onclick="refreshData()" class="btn" style="margin-top: 1rem;">
                            <i class="fas fa-refresh"></i>
                            Refresh Data
                        </button>
                    </div>
                `;
                return;
            }
            
            hospitalsContainer.innerHTML = hospitalsList.map(hospital => `
                <div class="card">
                    <h3>${hospital.name || 'Unknown Hospital'}</h3>
                    <p><i class="fas fa-map-marker-alt"></i> ${hospital.address || 'Address not available'}</p>
                    <p><i class="fas fa-phone"></i> ${hospital.phone || 'Phone not available'}</p>
                    <div style="margin: 1rem 0;">
                        <strong>Specialties:</strong>
                        <div style="margin-top: 0.5rem;">
                            ${(hospital.specialties || []).map(spec => 
                                `<span style="background: #e0f2fe; color: #0277bd; padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; margin-right: 0.5rem;">${spec}</span>`
                            ).join('')}
                        </div>
                    </div>
                    <button onclick="bookAtHospital('${hospital.id || ''}')" class="btn">
                        <i class="fas fa-calendar-plus"></i>
                        Book Appointment
                    </button>
                </div>
            `).join('');
        }

        function searchHospitals() {
            const searchTerm = document.getElementById('hospital-search').value.toLowerCase();
            
            if (!searchTerm) {
                displayHospitals(hospitals);
                return;
            }
            
            const filteredHospitals = hospitals.filter(hospital =>
                hospital.name.toLowerCase().includes(searchTerm) ||
                hospital.address.toLowerCase().includes(searchTerm) ||
                hospital.specialties.some(spec => spec.toLowerCase().includes(searchTerm))
            );
            
            displayHospitals(filteredHospitals);
        }

        function bookAtHospital(hospitalId) {
            showPage('booking');
        }

        async function sendMessage() {
            const chatInput = document.getElementById('chat-input');
            const chatContainer = document.getElementById('chat-container');
            const message = chatInput.value.trim();
            
            if (!message) return;
            
            // Add user message
            chatContainer.innerHTML += `
                <div style="margin-bottom: 1rem; text-align: right;">
                    <div style="background: #3b82f6; color: white; padding: 0.5rem 1rem; border-radius: 18px; display: inline-block; max-width: 70%;">
                        ${message}
                    </div>
                </div>
            `;
            
            chatInput.value = '';
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Add typing indicator
            chatContainer.innerHTML += `
                <div id="typing-indicator" style="margin-bottom: 1rem;">
                    <div style="background: #f3f4f6; color: #6b7280; padding: 0.5rem 1rem; border-radius: 18px; display: inline-block;">
                        <i class="fas fa-circle" style="animation: pulse 1.5s infinite;"></i>
                        <i class="fas fa-circle" style="animation: pulse 1.5s infinite 0.5s;"></i>
                        <i class="fas fa-circle" style="animation: pulse 1.5s infinite 1s;"></i>
                    </div>
                </div>
            `;
            
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            try {
                const response = await fetch('/api/analyze-symptoms', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ symptoms: message })
                });
                
                const result = await response.json();
                
                // Remove typing indicator
                document.getElementById('typing-indicator').remove();
                
                // Add AI response
                let aiResponse = 'I understand your concern. Based on what you\'ve described, I recommend consulting with a healthcare professional for proper evaluation and treatment.';
                
                // Handle different response formats
                if (result.analysis) {
                    if (typeof result.analysis === 'string') {
                        aiResponse = result.analysis;
                    } else if (result.analysis.response) {
                        aiResponse = result.analysis.response;
                    } else if (result.analysis.message) {
                        aiResponse = result.analysis.message;
                    } else if (result.analysis.reasoning && result.analysis.reasoning.includes('temporarily unavailable')) {
                        // API is returning generic response, use our smart fallback
                        aiResponse = generateFallbackResponse(message);
                    } else {
                        // If it's an object, use our smart fallback instead of showing raw JSON
                        aiResponse = generateFallbackResponse(message);
                    }
                } else if (result.response) {
                    aiResponse = result.response;
                } else if (result.message) {
                    aiResponse = result.message;
                } else {
                    // No valid response, use fallback
                    aiResponse = generateFallbackResponse(message);
                }
                
                chatContainer.innerHTML += `
                    <div style="margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe); color: #374151; padding: 1rem; border-radius: 18px; display: inline-block; max-width: 80%; border: 2px solid rgba(59, 130, 246, 0.2);">
                            <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                <span style="font-size: 1.2rem; margin-right: 0.5rem;">🤖</span>
                                <strong style="color: #1e40af;">AI Healthcare Assistant</strong>
                            </div>
                            ${aiResponse}
                        </div>
                    </div>
                `;
                
                chatContainer.scrollTop = chatContainer.scrollHeight;
            } catch (error) {
                // Remove typing indicator
                document.getElementById('typing-indicator')?.remove();
                
                // Provide intelligent fallback response
                let fallbackResponse = generateFallbackResponse(message);
                
                // Add AI response with fallback
                chatContainer.innerHTML += `
                    <div style="margin-bottom: 1rem;">
                        <div style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe); color: #374151; padding: 1rem; border-radius: 18px; display: inline-block; max-width: 80%; border: 2px solid rgba(59, 130, 246, 0.2);">
                            <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                <span style="font-size: 1.2rem; margin-right: 0.5rem;">🤖</span>
                                <strong style="color: #1e40af;">AI Healthcare Assistant</strong>
                            </div>
                            ${fallbackResponse}
                            <div style="margin-top: 0.5rem; font-size: 0.8rem; color: #6b7280; font-style: italic;">
                                💡 Note: This is a demo response. For accurate medical advice, please consult a healthcare professional.
                            </div>
                        </div>
                    </div>
                `;
                
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }



        function toggleMobileMenu() {
            const navMenu = document.getElementById('nav-menu');
            navMenu.classList.toggle('active');
        }

        function showToast(title, message, type = 'success') {
            const toast = document.getElementById('toast');
            if (!toast) return;
            
            const toastIcon = toast.querySelector('.toast-icon i');
            const toastTitle = toast.querySelector('.toast-title');
            const toastText = toast.querySelector('.toast-text');
            
            if (!toastIcon || !toastTitle || !toastText) return;
            
            // Update content
            toastTitle.textContent = title;
            toastText.textContent = message;
            
            // Update icon and color based on type
            if (type === 'success') {
                toastIcon.className = 'fas fa-check';
                toast.style.borderLeftColor = '#10b981';
                toast.querySelector('.toast-icon').style.background = '#10b981';
            } else if (type === 'error') {
                toastIcon.className = 'fas fa-exclamation-triangle';
                toast.style.borderLeftColor = '#ef4444';
                toast.querySelector('.toast-icon').style.background = '#ef4444';
            } else if (type === 'info') {
                toastIcon.className = 'fas fa-info-circle';
                toast.style.borderLeftColor = '#3b82f6';
                toast.querySelector('.toast-icon').style.background = '#3b82f6';
            }
            
            // Show toast
            toast.classList.add('show');
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                hideToast();
            }, 5000);
        }

        function hideToast() {
            document.getElementById('toast').classList.remove('show');
        }

        function rescheduleAppointment(appointmentId) {
            showToast('Reschedule', 'Reschedule functionality will be available soon', 'info');
        }

        function cancelAppointment(appointmentId) {
            if (confirm('Are you sure you want to cancel this appointment?')) {
                showToast('Cancelled', 'Your appointment has been cancelled', 'success');
                loadUserAppointments();
            }
        }

        // Admin Panel Functions
        async function loadAdminData() {
            try {
                const response = await fetch('/api/appointments');
                allAppointments = await response.json();
                filteredAppointments = [...allAppointments];
                updateAdminStats();
                displayAdminAppointments();
            } catch (error) {
                console.error('Error loading admin data:', error);
            }
        }

        function updateAdminStats() {
            document.getElementById('total-appointments').textContent = allAppointments.length;
            document.getElementById('active-doctors').textContent = doctors.length;
            document.getElementById('pending-appointments').textContent = 
                allAppointments.filter(apt => apt.status === 'pending').length;
        }

        function displayAdminAppointments() {
            const adminAppointmentsList = document.getElementById('admin-appointments-list');
            if (!adminAppointmentsList) return;
            
            if (!filteredAppointments || !Array.isArray(filteredAppointments) || filteredAppointments.length === 0) {
                adminAppointmentsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6b7280;">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No appointments found matching your criteria.</p>
                        <button onclick="refreshData()" class="btn" style="margin-top: 1rem;">
                            <i class="fas fa-refresh"></i>
                            Refresh Data
                        </button>
                    </div>
                `;
                return;
            }

            adminAppointmentsList.innerHTML = filteredAppointments.map(appointment => `
                <div class="card" style="margin-bottom: 1rem; border-left: 4px solid ${getStatusColor(appointment.status)};">
                    <div class="grid-2">
                        <div>
                            <h4 style="color: #1a202c; margin-bottom: 0.5rem;">${appointment.patientName}</h4>
                            <p><i class="fas fa-id-card"></i> ID: ${appointment.id}</p>
                            <p><i class="fas fa-user-md"></i> Dr. ${appointment.doctorName}</p>
                            <p><i class="fas fa-stethoscope"></i> ${appointment.specialty}</p>
                            <p><i class="fas fa-map-marker-alt"></i> ${appointment.location}</p>
                        </div>
                        <div>
                            <p><i class="fas fa-calendar"></i> ${new Date(appointment.date).toLocaleDateString('en-IN')}</p>
                            <p><i class="fas fa-clock"></i> ${appointment.time}</p>
                            <p><i class="fas fa-phone"></i> ${appointment.mobile}</p>
                            <p><i class="fas fa-envelope"></i> ${appointment.email}</p>
                            <div style="margin-top: 1rem;">
                                <span style="background: ${getStatusColor(appointment.status)}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">
                                    ${appointment.status.charAt(0).toUpperCase() + appointment.status.slice(1)}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    ${appointment.symptoms ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e5e7eb;">
                            <p><strong>Symptoms:</strong> ${appointment.symptoms}</p>
                        </div>
                    ` : ''}
                    
                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        ${appointment.status === 'pending' ? `
                            <button class="btn" style="background: #10b981;" onclick="updateAppointmentStatus('${appointment.id}', 'confirmed')">
                                <span style="font-size: 1rem; margin-right: 0.5rem;">✅</span>
                                Confirm
                            </button>
                        ` : ''}
                        ${appointment.status !== 'cancelled' && appointment.status !== 'completed' ? `
                            <button class="btn" style="background: #f59e0b;" onclick="rescheduleAdminAppointment('${appointment.id}')">
                                <span style="font-size: 1rem; margin-right: 0.5rem;">📅</span>
                                Reschedule
                            </button>
                            <button class="btn" style="background: #ef4444;" onclick="updateAppointmentStatus('${appointment.id}', 'cancelled')">
                                <span style="font-size: 1rem; margin-right: 0.5rem;">❌</span>
                                Cancel
                            </button>
                        ` : ''}
                        ${appointment.status === 'confirmed' ? `
                            <button class="btn" style="background: #6b7280;" onclick="updateAppointmentStatus('${appointment.id}', 'completed')">
                                <span style="font-size: 1rem; margin-right: 0.5rem;">🏁</span>
                                Mark Complete
                            </button>
                        ` : ''}
                        <button class="btn" style="background: #8b5cf6;" onclick="viewPatientDetails('${appointment.id}')">
                            <span style="font-size: 1rem; margin-right: 0.5rem;">👤</span>
                            View Patient
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function filterAppointments() {
            const searchTerm = document.getElementById('admin-search').value.toLowerCase();
            const statusFilter = document.getElementById('status-filter').value;
            
            filteredAppointments = allAppointments.filter(appointment => {
                const matchesSearch = !searchTerm || 
                    appointment.patientName.toLowerCase().includes(searchTerm) ||
                    appointment.id.toLowerCase().includes(searchTerm) ||
                    appointment.doctorName.toLowerCase().includes(searchTerm);
                    
                const matchesStatus = !statusFilter || appointment.status === statusFilter;
                
                return matchesSearch && matchesStatus;
            });
            
            displayAdminAppointments();
        }

        async function updateAppointmentStatus(appointmentId, newStatus) {
            try {
                const response = await fetch(`/api/appointments/${appointmentId}/status`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ status: newStatus })
                });
                
                if (response.ok) {
                    // Update local data
                    const appointmentIndex = allAppointments.findIndex(apt => apt.id === appointmentId);
                    if (appointmentIndex !== -1) {
                        allAppointments[appointmentIndex].status = newStatus;
                    }
                    
                    const filteredIndex = filteredAppointments.findIndex(apt => apt.id === appointmentId);
                    if (filteredIndex !== -1) {
                        filteredAppointments[filteredIndex].status = newStatus;
                    }
                    
                    showToast('Status Updated', `Appointment ${newStatus} successfully`, 'success');
                    updateAdminStats();
                    displayAdminAppointments();
                } else {
                    throw new Error('Failed to update appointment status');
                }
            } catch (error) {
                showToast('Update Failed', error.message, 'error');
            }
        }

        function rescheduleAdminAppointment(appointmentId) {
            showToast('Reschedule', 'Admin reschedule functionality will be available soon', 'info');
        }

        function viewPatientDetails(appointmentId) {
            const appointment = allAppointments.find(apt => apt.id === appointmentId);
            if (appointment) {
                alert(`Patient Details:\n\nName: ${appointment.patientName}\nAge: ${appointment.age}\nMobile: ${appointment.mobile}\nEmail: ${appointment.email}\nLanguage: ${appointment.preferredLanguage}\nSymptoms: ${appointment.symptoms || 'Not specified'}`);
            }
        }

        function generateFallbackResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Doctor availability responses
            if (lowerMessage.includes('doctor') && (lowerMessage.includes('available') || lowerMessage.includes('many'))) {
                return `🏥 We have ${doctors.length} qualified doctors available across multiple specialties including Cardiology, Pediatrics, Orthopedics, and General Medicine. You can view all available doctors in our "Book Appointment" section where you can filter by specialty and language preferences.`;
            }
            
            // General doctor inquiry
            if (lowerMessage === 'doctors' || lowerMessage === 'doctor') {
                const specialties = [...new Set(doctors.map(doc => doc.specialty))];
                return `👨‍⚕️ Our medical team includes ${doctors.length} experienced doctors across ${specialties.length} specialties:
                
📋 **Available Specialties:**
${specialties.map(specialty => `• ${specialty}`).join('\n')}

🔍 **Featured Doctors:**
• Dr. Rajesh Sharma - Cardiology
• Dr. Priya Patel - Pediatrics  
• Dr. Amit Kumar - Orthopedics

You can book an appointment with any of our doctors through the "🤖 Book Appointment" page. Our AI will help match you with the right specialist based on your symptoms and preferences!`;
            }
            
            // Symptom-based responses
            if (lowerMessage.includes('headache')) {
                return `🩺 For headache concerns, I recommend consulting with our General Medicine or Neurology specialists. Headaches can have various causes from stress to underlying conditions. You can book an appointment with Dr. Rajesh Sharma (Cardiology) or Dr. Priya Patel (Pediatrics) through our booking system.`;
            }
            
            if (lowerMessage.includes('fever')) {
                return `🌡️ **Fever Assessment & Care**

**Immediate Recommendations:**
• Monitor your temperature regularly
• Stay hydrated with plenty of fluids
• Rest and avoid strenuous activities
• Consider over-the-counter fever reducers if needed

**When to Seek Medical Care:**
• Fever above 103°F (39.4°C)
• Fever lasting more than 3 days
• Accompanied by severe symptoms (difficulty breathing, chest pain, persistent vomiting)

**Our Available Doctors:**
• **Dr. Rajesh Sharma** - Cardiology (if heart-related concerns)
• **Dr. Priya Patel** - Pediatrics (for children)
• **General Medicine specialists** - For comprehensive evaluation

📅 Book an appointment through our "🤖 Book Appointment" page for proper diagnosis and treatment. We offer same-day appointments for urgent cases!`;
            }
            
            if (lowerMessage.includes('pain') || lowerMessage.includes('hurt')) {
                return `😣 For pain management, our Orthopedics and General Medicine specialists can help diagnose and treat your condition. Dr. Amit Kumar specializes in orthopedic issues, while our general medicine doctors handle various pain conditions.`;
            }
            
            // Appointment-related responses
            if (lowerMessage.includes('appointment') || lowerMessage.includes('book')) {
                return `📅 You can easily book an appointment through our AI-powered booking system! Simply go to the "Book Appointment" page, select your preferred doctor and specialty, choose a convenient time slot, and our AI will help match you with the best available doctor based on your needs.`;
            }
            
            // Hospital information
            if (lowerMessage.includes('hospital') || lowerMessage.includes('location')) {
                return `🏥 We partner with leading hospitals including Apollo Hospitals, Fortis Healthcare, Max Healthcare, Manipal Hospitals, and Narayana Health. You can search for hospitals near you using our "Search Hospitals" feature to find the most convenient location.`;
            }
            
            // Default response
            return `Thank you for your question! While I'm currently in demo mode, I can help you with information about our ${doctors.length} available doctors, hospital locations, and appointment booking. For specific medical advice, I recommend booking a consultation with one of our qualified healthcare professionals through our booking system.`;
        }

        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Close mobile menu if open
            const navMenu = document.getElementById('nav-menu');
            if (navMenu) {
                navMenu.classList.remove('active');
            }
            
            // Load specific page data
            if (pageId === 'admin') {
                loadAdminData();
            } else if (pageId === 'booking') {
                updateBookingPageAuth();
            }
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function updateBookingPageAuth() {
            const loginNotice = document.getElementById('login-required-notice');
            const bookingFormContainer = document.getElementById('booking-form-container');
            
            if (!currentUser) {
                // User not logged in - show login notice, hide form
                if (loginNotice) loginNotice.style.display = 'block';
                if (bookingFormContainer) bookingFormContainer.style.display = 'none';
            } else {
                // User logged in - hide login notice, show form
                if (loginNotice) loginNotice.style.display = 'none';
                if (bookingFormContainer) bookingFormContainer.style.display = 'block';
                
                // Pre-fill user information
                const patientNameField = document.getElementById('patient-name');
                const mobileField = document.getElementById('mobile');
                const emailField = document.getElementById('email');
                
                if (patientNameField && currentUser.name) patientNameField.value = currentUser.name;
                if (mobileField && currentUser.mobile) mobileField.value = currentUser.mobile;
                if (emailField && currentUser.email) emailField.value = currentUser.email;
            }
        }

        function refreshData() {
            showToast('Refreshing', 'Reloading data...', 'info');
            initializeArrays();
            loadInitialData();
        }

        // Receipt and Payment Functions
        function showBookingReceipt(appointmentDetails) {
            const receiptContent = document.getElementById('receipt-content');
            const consultationFee = 500; // Base consultation fee
            const platformFee = 50;
            const total = consultationFee + platformFee;
            
            receiptContent.innerHTML = `
                <div class="receipt-header">
                    <h3>🏥 HOSPITAL SCHEDULER</h3>
                    <p>Appointment Booking Receipt</p>
                    <small>Receipt #${appointmentDetails.id}</small>
                </div>
                
                <div class="receipt-row">
                    <span>Patient Name:</span>
                    <span>${appointmentDetails.patientName}</span>
                </div>
                <div class="receipt-row">
                    <span>Doctor:</span>
                    <span>Dr. ${appointmentDetails.doctorName}</span>
                </div>
                <div class="receipt-row">
                    <span>Specialty:</span>
                    <span>${appointmentDetails.specialty}</span>
                </div>
                <div class="receipt-row">
                    <span>Hospital:</span>
                    <span>${appointmentDetails.location}</span>
                </div>
                <div class="receipt-row">
                    <span>Date:</span>
                    <span>${new Date(appointmentDetails.date).toLocaleDateString('en-IN')}</span>
                </div>
                <div class="receipt-row">
                    <span>Time:</span>
                    <span>${appointmentDetails.time}</span>
                </div>
                <div class="receipt-row">
                    <span>Mobile:</span>
                    <span>${appointmentDetails.mobile}</span>
                </div>
                <div class="receipt-row">
                    <span>Language:</span>
                    <span>${appointmentDetails.language}</span>
                </div>
                <div class="receipt-row">
                    <span>Booking Date:</span>
                    <span>${new Date(appointmentDetails.bookedAt).toLocaleString('en-IN')}</span>
                </div>
                
                <div class="receipt-row">
                    <span>Consultation Fee:</span>
                    <span>₹${consultationFee}</span>
                </div>
                <div class="receipt-row">
                    <span>Platform Fee:</span>
                    <span>₹${platformFee}</span>
                </div>
                <div class="receipt-row total">
                    <span>Total Amount:</span>
                    <span>₹${total}</span>
                </div>
                
                <div style="text-align: center; margin-top: 2rem; font-size: 0.9rem; color: #6b7280;">
                    <p>Thank you for choosing Hospital Scheduler!</p>
                    <p>Please arrive 15 minutes before your appointment.</p>
                </div>
            `;
            
            // Store current appointment for payment
            window.currentAppointment = appointmentDetails;
            window.appointmentTotal = total;
            
            document.getElementById('receipt-modal').style.display = 'flex';
        }

        function closeReceiptModal() {
            document.getElementById('receipt-modal').style.display = 'none';
        }

        function printReceipt() {
            const receiptContent = document.getElementById('receipt-content').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>Appointment Receipt</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .receipt-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 20px; }
                            .receipt-row { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 5px 0; }
                            .receipt-row.total { border-top: 1px solid #000; margin-top: 20px; padding-top: 20px; font-weight: bold; }
                        </style>
                    </head>
                    <body>
                        ${receiptContent}
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function showPaymentOptions() {
            document.getElementById('payment-modal').style.display = 'flex';
        }

        function closePaymentModal() {
            document.getElementById('payment-modal').style.display = 'none';
        }

        function processRazorpayPayment() {
            if (!window.currentAppointment) {
                showToast('Error', 'No appointment selected for payment', 'error');
                return;
            }

            const options = {
                key: 'rzp_test_demo', // Demo key
                amount: window.appointmentTotal * 100, // Amount in paise
                currency: 'INR',
                name: '🏥 AI Hospital Scheduler',
                description: `Appointment with Dr. ${window.currentAppointment.doctorName}`,
                handler: function(response) {
                    showToast('Payment Successful', `Payment ID: ${response.razorpay_payment_id}`, 'success');
                    closePaymentModal();
                    closeReceiptModal();
                    setTimeout(() => {
                        showPage('appointments');
                    }, 2000);
                },
                prefill: {
                    name: window.currentAppointment.patientName,
                    email: window.currentAppointment.email,
                    contact: window.currentAppointment.mobile
                },
                theme: {
                    color: '#3b82f6'
                }
            };

            try {
                const rzp = new Razorpay(options);
                rzp.open();
            } catch (error) {
                // Fallback for demo
                showToast('Demo Payment', 'Payment processed successfully (Demo Mode)', 'success');
                closePaymentModal();
                closeReceiptModal();
                setTimeout(() => {
                    showPage('appointments');
                }, 2000);
            }
        }

        function showUPIPayment() {
            showToast('UPI Payment', 'UPI payment will be available soon', 'info');
        }

        function showCardPayment() {
            showToast('Card Payment', 'Card payment will be available soon', 'info');
        }
    </script>
</body>
</html>
